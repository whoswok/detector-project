services:
  - builder:
      buildCommand: "echo 'No build required for demo'"
      startCommand: "echo 'Services will be started via docker-compose'"

  - type: web
    name: detector-app
    env: docker-compose
    buildCommand: ""
    startCommand: |
      # Install Docker Compose
      curl -L "https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
      chmod +x /usr/local/bin/docker-compose

      # Create demo script
      cat > demo.sh << 'EOF'
      #!/bin/bash
      echo "ðŸš€ Detector Project Live Demo"
      echo "Starting services..."

      # Start core services (without parser service for demo)
      docker-compose up -d elasticsearch kibana

      # Wait for services
      sleep 45

      echo "âœ… Services started!"
      echo "ðŸŒ Kibana Dashboard: $(echo $RAILWAY_STATIC_URL | sed 's|https://||')"
      echo "ðŸ” Elasticsearch: $(echo $RAILWAY_STATIC_URL | sed 's|https://||'):9200"
      echo ""
      echo "ðŸ“Š Demo Features:"
      echo "â€¢ Real-time log processing simulation"
      echo "â€¢ ML-based anomaly detection"
      echo "â€¢ Interactive Kibana dashboards"
      echo "â€¢ Multi-channel alerting system"
      EOF

      chmod +x demo.sh

      # Start services
      docker-compose up -d elasticsearch kibana

      # Create startup message
      echo "ðŸŽ‰ Detector Project Deployed Successfully!"
      echo "ðŸ“Š Kibana: https://$(echo $RAILWAY_STATIC_URL | cut -d'/' -f3)"
      echo "ðŸ” Elasticsearch: https://$(echo $RAILWAY_STATIC_URL | cut -d'/' -f3):9200"
      echo ""
      echo "ðŸš€ Demo ready! Access the dashboard above."
